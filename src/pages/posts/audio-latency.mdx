---
layout: "@layouts/PostLayout.astro"
title: fixing audio latency on Windows
description: I recently watched techless's video on audio latency, which opened my eyes to how horrible audio latency is on Windows. This led me down a 3-month-long rabbit hole of forums & Discord servers, but eventually I managed to drop my audio latency by over 40ms, with it going down from 75ms~ to around 35ms~ in tests. In this post I'll go over what I've changed in my setup to reduce latency, and the same steps should apply for anyone who has similar components. If you have a different DAC/audio interface/GPU/headphones etc there might be some difference, but for the most part the same steps should help you.
date: 2025-12-31
---

export const results = {
  gpu_dp_monitor_windows: {
    label: "gpu → displayport → monitor 3.5mm out (windows drivers)",
    latency: 35,
    focus: "latency",
  },
  gpu_dp_monitor_nvidia: {
    label: "gpu → displayport → monitor 3.5mm out (nvidia drivers)",
    latency: 100,
    focus: "latency",
  },
  mobo_windows: {
    label: "mobo 3.5mm out (windows drivers)",
    latency: 35,
    focus: "latency",
  },
  mobo_realtek: {
    label: "mobo 3.5mm out (realtek drivers)",
    latency: 80,
    focus: "latency",
  },
  gpu_extractor_optical_dac_windows: {
    label: "gpu → hdmi extractor → optical → dac (windows drivers)",
    latency: 41,
    focus: "quality",
  },
  usb_dac_windows: {
    label: "usb → dac (windows drivers)",
    latency: 75,
    focus: "quality",
  },
};

import * as Plot from "@observablehq/plot";
import LatencyPlot from "@components/LatencyPlot";

I recently watched [techless's video on audio latency](https://www.youtube.com/watch?v=okIpbu1tp_A), which opened my eyes to how horrible audio latency is on Windows. This led me down a 3-month-long rabbit hole of forums & Discord servers, but eventually I managed to drop my audio latency by over {results.usb_dac_windows.latency - results.gpu_dp_monitor_windows.latency}ms, with it going down from {results.usb_dac_windows.latency}ms~ to around {results.gpu_dp_monitor_windows.latency}ms~ in tests.

In this post I'll go over what I've changed in my setup to reduce latency, and the same steps should apply for anyone who has similar components. If you have a different DAC/audio interface/GPU/headphones etc there might be some difference, but for the most part the same steps _should_ help you.

Pretty much all the credit for the information in this post goes to the #audio channel in the [Latency & Gaming Discord](https://discord.com/invite/Nc6USePjA3). The people in there are far more knowledgeable than me, so if you have any questions or issues I suggest checking the pins & searching in there, as someone's probably already asked the same thing.

## testing latency

Use [this online test](https://superpowered.com/webbrowserlatency) to see what your audio latency is, and how it changes as you make adjustments to your setup.

You'll want to use a 3.5mm mic for this, as USB/XLR mics will have additional latency, skewing the results. You'll still be able to see whether your latency improves from the changes you make, but your numbers will be higher than they should be.

You also need to use a hardware-accelerated browser. [Thorium](https://thorium.rocks/) is what I've seen recommended, and is what I used in my testing. Using my regular browser (Brave) produces much slower results, and it doesn't seem to work at all on Firefox.

## guide

### hardware

#### i dont care about audio quality

If you don't care about audio quality, as far as I know the best audio latency you can get will come connecting your headphones to the 3.5mm audio port on either your motherboard (only if it's [alc1220 or alc897](https://docs.google.com/spreadsheets/d/1NQHkDEcgDPm34Mns3C93K6SJoBnua-x9O-y_6hv8sPs/edit), I believe) or your monitor (most monitors, probably).

For both these options you'll be using the DACs inside either your motherboard or monitor, which probably suck, but in my testing I got latency of {results.gpu_dp_monitor_windows.latency}ms~ via this method from both my motherboard (Gigabyte B650M GAMING PLUS WIFI) and monitor (Samsung G60SD).

If you do choose this method, you'll still need to follow [the drivers section of this guide](./audio-latency.mdx#drivers). On my monitor, latency was {results.gpu_dp_monitor_nvidia.latency}ms~ before fixing drivers, and on my motherboard it was {results.mobo_realtek.latency}ms~.

<LatencyPlot
  data={Object.values(results).filter((result) => result.focus === "latency")}
  alt="Latency-focused results summary"
/>

#### i care about audio quality

If you care about audio quality then I'm assuming you're using a DAC or an audio interface which you plug your headphones into. If you don't already have anything, I recommend getting a DAC rather than an audio interface, unless you really want a single device for both your headphones and microphone. This is because the audio outputs on interfaces are primarily designed for monitoring recordings rather than general use, so they'll typically sound worse than a dedicated DAC. I won't get into recommendations here, but I'm using a Topping DX3 Pro+.

If you want good latency, then whatever you use will need the ability to use an optical input. USB audio tends to give around 30ms of extra latency.

##### option 1: optical out on your motherboard

Ideally you'd just use the TOSLINK optical out port on your motherboard and connect that to your DAC. Most high-end boards have these, but I've got a budget Micro ATX board which doesn't. There are a couple other ways of using optical audio if you're in the same boat.

##### option 2: HDMI audio extractor (my choice)

This is the option that should work for everyone. You can buy any cheap HDMI audio extractor and connect it to your GPU, and it'll give you an optical out port which you can plug into your DAC/audio interface. As far as I know there's no point to buying a more expensive/premium one - I bought the cheapest one with good reviews I could find off AliExpress for $5 AUD.

The downside to this though is you'll have an extra display show up in Windows which by default you can't hide, as removing the display also stops the audio output. However if you're on Windows 11 Pro 23h2 or newer, or a server edition, then [DisplayWakeUp](https://github.com/O-Robotic/DisplayWakeUp) will let you remove it.

<LatencyPlot
  data={Object.values(results).filter((result) => result.focus === "quality")}
  alt="Quality-focused results summary"
/>

##### option 3: sound card

You can also buy pretty much any sound card and they'll come with an optical out port, however there are a couple reasons why you should avoid this option if possible. Firstly, and most importantly, it takes up a PCIe slot, so you might not be able to fit one in your PC. I can't, as my GPU is covering up my second PCIe slot.

Secondly, if you play games with kernel level anticheats, then they might block your sound card's drivers from loading, making them a dealbreaker.

Finally, you likely can't use MSI mode when using them. See [#msi-mode](./audio-latency.mdx#msi-mode) for more details on why that matters.

### software

#### drivers

I'm not 100% on this, but I believe you want Windows to use its native audio drivers if you want the best possible latency. As mentioned earlier, before I did this my optical & monitor's 3.5mm results were both above 90ms. After fixing my drivers they went down to {results.gpu_extractor_optical_dac_windows.latency}ms~ / {results.gpu_dp_monitor_windows.latency}ms~.

Firstly, you'll want to stop Windows from installing its own updated audio drivers (probably some random Realtek version). You can find your own way of doing this, or run [valleyofdoom's registry script](https://github.com/valleyofdoom/PC-Tuning#117-merging-registry-options-permalink). This does some other stuff (all good, though you might not want to disable Defender), but importantly `disable driver installation via windows update` stops Windows from installing its own drivers. You might need to go into safe mode for it to run properly.

You'll also need to get rid of your existing drivers. I used [Display Driver Uninstaller (DDU)](https://www.guru3d.com/download/display-driver-uninstaller-download/) for this - I removed both my audio (Realtek) drivers and my Nvidia drivers. I then reinstalled my Nvidia drivers, making sure to customise the installation and uncheck 'HD Audio Drivers'.

As for DAC/audio interface drivers, you'll want to set the buffer size to the lowest amount you can. This is probably done via their software. If you're getting pops/crackles then bump it up, but keep it as low as possible for the least latency. Once you're done, remove the drivers. The drivers/software for some audio interfaces add a ton of latency, with Focusrite being a notable offender.

#### misc

##### msi mode

You can also [enable MSI mode](https://forums.guru3d.com/threads/windows-line-based-vs-message-signaled-based-interrupts-msi-tool.378044) to reduce your system's [DPC and ISR calls](https://repo.zenk-security.com/Linux%20et%20systemes%20d.exploitations/Windows%20Internals%20Part%201_6th%20Edition.pdf#page=123) and potentially shave off a few milliseconds. From my testing I got around 2ms~ less latency with it on over 8 tests, but that's low enough that it might just be margin of error. This isn't required to have good latency, and is something I'm no expert on, but is widely recommended and is good practice.

## end

To sum stuff up:

<LatencyPlot data={Object.values(results)} />

- using 3.5mm out on monitor/mobo = {results.gpu_dp_monitor_windows.latency}ms~
  - Non-Windows drivers = +50ms~, uninstall drivers, block Windows Update from installing any & don't install Nvidia's audio drivers
- using DAC/interface = {results.gpu_extractor_optical_dac_windows.latency}ms~, depends on DAC
  - USB connection = +30ms~, use optical
  - optical connection + non-Windows drivers = +50ms~, uninstall drivers, block Windows Update from installing any & don't install Nvidia's audio drivers

There might be ways to bring latency down slightly more, but I haven't seen anyone get results lower than this.
